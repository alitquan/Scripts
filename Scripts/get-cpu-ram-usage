# need to run periodically in Task Scheduler

# Collecting CPU and Memory Usage
$cpu = Get-Counter '\Processor(_Total)\% Processor Time'
$memory = Get-Counter '\Memory\Available MBytes'

# Custom object 
$data = [PSCustomObject]@{
    TimeStamp = (Get-Date).ToString("yyyy-MM-dd HH:mm:ss")
    CPUUsage = $cpu.CounterSamples[0].CookedValue
    MemoryAvailableMB = $memory.CounterSamples[0].CookedValue
}

# Export to CSV
$data | Export-Csv -Path "C:\cpu_memory_usage.csv" -Append -NoTypeInformation
